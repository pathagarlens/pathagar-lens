<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Pathagar Len's - Fact Check</title>

<link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;600&display=swap" rel="stylesheet">

<style>
*{
    margin:0;
    padding:0;
    box-sizing:border-box;
    font-family:'Poppins', sans-serif;
}

body{
    background:#f4f6fb;
    color:#333;
}

/* HEADER (Same as index.html) */
header{
    background:#0a2540;
    color:white;
    padding:15px 40px;
    display:flex;
    justify-content:space-between;
    align-items:center;
    position:sticky;
    top:0;
    z-index:1000;
}

.logo-container{
    display:flex;
    align-items:center;
}

.logo-img{
    width:34px;
    height:34px;
    margin-right:10px;
}

.logo{
    font-size:22px;
    font-weight:600;
    text-decoration:none;
    color:white;
}

.menu-wrapper{
    display:flex;
    align-items:center;
    cursor:pointer;
    font-size:15px;
    user-select:none;
    position:relative;
}

.menu-wrapper span{
    margin-left:6px;
}

.menu-icon{
    font-size:22px;
}

.dropdown{
    position:absolute;
    right:0;
    top:45px;
    background:white;
    width:220px;
    box-shadow:0 8px 20px rgba(0,0,0,0.15);
    border-radius:8px;
    display:none;
    flex-direction:column;
    overflow:hidden;
}

.dropdown a{
    padding:12px 18px;
    text-decoration:none;
    color:#0a2540;
    font-size:14px;
    transition:0.3s;
}

.dropdown a:hover{
    background:#f1f4f8;
}

/* FACT SECTION */
.container{
    max-width:1000px;
    margin:50px auto;
    background:white;
    padding:30px;
    border-radius:12px;
    box-shadow:0 10px 25px rgba(0,0,0,0.08);
}

.container h2{
    margin-bottom:20px;
    color:#0a2540;
}

input, select{
    width:100%;
    padding:12px;
    margin-bottom:15px;
    border:1px solid #ccc;
    border-radius:6px;
}

button{
    padding:12px 25px;
    background:#0a2540;
    color:white;
    border:none;
    border-radius:6px;
    cursor:pointer;
}

button:hover{
    background:#144272;
}

.card{
    background:#ffffff;
    padding:18px;
    margin-bottom:18px;
    border-radius:10px;
    box-shadow:0 4px 15px rgba(0,0,0,0.05);
}

.badge{
    padding:4px 10px;
    border-radius:20px;
    font-size:12px;
    font-weight:bold;
}

.high{
    background:#d4edda;
    color:#155724;
}

.low{
    background:#f8d7da;
    color:#721c24;
}

.verdict{
    padding:12px;
    margin-bottom:20px;
    border-radius:8px;
    font-weight:bold;
}

.true{background:#d4edda;color:#155724;}
.mixed{background:#fff3cd;color:#856404;}
.review{background:#f8d7da;color:#721c24;}

/* FOOTER (Same as index.html) */
footer{
    background:#0a2540;
    color:white;
    padding:40px 20px;
    margin-top:60px;
}

.footer-container{
    display:flex;
    justify-content:space-between;
    flex-wrap:wrap;
    max-width:1100px;
    margin:auto;
}

.footer-section{
    margin:15px 0;
}

.footer-section h4{
    margin-bottom:12px;
    font-weight:600;
}

.footer-section a{
    display:block;
    color:white;
    text-decoration:none;
    font-size:14px;
    margin-bottom:6px;
}

.footer-bottom{
    text-align:center;
    margin-top:25px;
    font-size:14px;
    border-top:1px solid rgba(255,255,255,0.2);
    padding-top:15px;
}

.footer-extra{
    text-align:center;
    font-size:13px;
    margin-top:10px;
    opacity:0.85;
}
</style>
</head>

<body>

<header>
    <div class="logo-container">
        <img src="mainlogo.jpg" class="logo-img" alt="Logo">
        <a href="index.html" class="logo">Pathagar Len's</a>
    </div>

    <div class="menu-wrapper" id="menuToggle">
        <div class="menu-icon">⋮</div>
        <span>Menu</span>
        <div class="dropdown" id="menu">
            <a href="index.html">Home</a>
            <a href="fact.html">Fact Check</a>
            <a href="books.html">Books</a>
            <a href="research.html">Research</a>
            <a href="#">User Login</a>
            <a href="#" style="font-weight:600; color:#c0392b;">Admin Login</a>
        </div>
    </div>
</header>

<div class="container">

<h2>Fact Verification System</h2>

<input type="text" id="claimInput" placeholder="Enter claim (e.g., accident India)">

<select id="filter">
  <option value="all">All Sources</option>
  <option value="high">High Credibility Only</option>
</select>

<button onclick="search()">Verify Claim</button>

<div id="verdictBox"></div>
<div id="result"></div>

<button id="loadMoreBtn" onclick="loadMore()" style="display:none;">
Load More
</button>

</div>

<footer>
  <div class="footer-container">
    <div class="footer-section">
      <h4>Menu</h4>
      <a href="index.html">Home</a>
      <a href="fact.html">Fact Check</a>
      <a href="books.html">Books</a>
      <a href="research.html">Research</a>
      <a href="#">User Login</a>
      <a href="#">Admin Login</a>
    </div>

    <div class="footer-section">
      <h4>Information</h4>
      <a href="#">About Us</a>
      <a href="#">Contact</a>
      <a href="#">Privacy Policy</a>
      <a href="#">Terms & Conditions</a>
    </div>
  </div>

  <div class="footer-bottom">
    © <span id="year"></span> Pathagar Len's Fully Digital Library. All rights reserved.
  </div>

  <div class="footer-extra">
    Last Live Update: <span id="liveDate"></span> |
    Design by Paradip Sen Roy |
    Total Visitors: <span id="visitCount"></span>
  </div>
</footer>

<script>

/* MENU */
const menuToggle = document.getElementById("menuToggle");
const menu = document.getElementById("menu");

menuToggle.addEventListener("click", function(e){
    e.stopPropagation();
    menu.style.display = menu.style.display === "flex" ? "none" : "flex";
});

document.addEventListener("click", function(){
    menu.style.display = "none";
});

menu.addEventListener("click", function(e){
    e.stopPropagation();
});

/* Footer Dynamic Info */
document.getElementById("year").textContent = new Date().getFullYear();
document.getElementById("liveDate").textContent = new Date().toLocaleString();

if(!localStorage.getItem("visitCount")){
    localStorage.setItem("visitCount", 1);
}else{
    localStorage.setItem("visitCount", parseInt(localStorage.getItem("visitCount")) + 1);
}
document.getElementById("visitCount").textContent = localStorage.getItem("visitCount");

/* FACT SYSTEM */
let allResults = [];
let visibleCount = 0;
const batchSize = 5;

async function search(){

  const claim = document.getElementById("claimInput").value.trim();
  if(!claim) return alert("Enter claim");

  document.getElementById("result").innerHTML = "Loading...";
  document.getElementById("verdictBox").innerHTML = "";
  document.getElementById("loadMoreBtn").style.display="none";

  const response = await fetch("https://pathagar-lens.onrender.com/api/fact/check",{
    method:"POST",
    headers:{"Content-Type":"application/json"},
    body:JSON.stringify({claim})
  });

  const data = await response.json();

  allResults = data.results || [];
  visibleCount = 0;

  showVerdict();
  document.getElementById("result").innerHTML="";
  displayMore();
}

function showVerdict(){

  let highCount = allResults.filter(r=>r.credibility==="High").length;

  let verdictText = "Needs Verification";
  let verdictClass = "review";

  if(highCount >= 3){
    verdictText = "Likely True";
    verdictClass = "true";
  } else if(highCount >= 1){
    verdictText = "Mixed Information";
    verdictClass = "mixed";
  }

  document.getElementById("verdictBox").innerHTML = `
    <div class="verdict ${verdictClass}">
      Overall Verdict: ${verdictText}
    </div>
  `;
}

function displayMore(){

  const filter = document.getElementById("filter").value;
  const container = document.getElementById("result");

  let filtered = allResults;

  if(filter==="high"){
    filtered = allResults.filter(r=>r.credibility==="High");
  }

  const nextBatch = filtered.slice(visibleCount, visibleCount + batchSize);

  nextBatch.forEach(article=>{
    container.innerHTML+=`
      <div class="card">
        <h4>${article.title}</h4>
        <span class="badge ${article.credibility==="High"?"high":"low"}">
          ${article.credibility}
        </span>
        <br><br>
        <a href="${article.link}" target="_blank">Read Full Article</a>
      </div>
    `;
  });

  visibleCount += batchSize;

  if(visibleCount < filtered.length){
    document.getElementById("loadMoreBtn").style.display="block";
  } else {
    document.getElementById("loadMoreBtn").style.display="none";
  }
}

function loadMore(){
  displayMore();
}

document.getElementById("filter").addEventListener("change", ()=>{
  visibleCount = 0;
  document.getElementById("result").innerHTML="";
  displayMore();
});

</script>

</body>
</html>
